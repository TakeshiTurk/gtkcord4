name: Install Nix packages
inputs:
  shell:
    default: true
  instantiated-expression:
    required: false
runs:
  using: composite
  steps:
    - name: Initialize Action
      shell: bash
      run: |
        if [[ "${SHELL,,}" == true ]]; then
          echo "::set-output name=shell-file::shell.nix"
        else
          echo "::set-output name=shell-file::"
        fi
      env:
        SHELL: ${{ inputs.shell }}

    - name: Install Nix shell
      uses: diamondburned/cache-install@bc96fc2e2fc72007eb4675e79da8a3472717eee8
      with:
        auto-optimise: ${{ inputs.auto-optimise }}
        shell-file: ${{ steps.init.outputs.shell-file }}
        instantiated-expression: ${{ inputs.instantiated-expression }}
